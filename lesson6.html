<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dangerous Maze NÃ¢ng Cao - Buá»•i 6</title>
  <link rel="stylesheet" href="style.css" />
  <parameter name="mermaid-script">  <script type="module">
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
    mermaid.initialize({
      startOnLoad: true,
      theme: "dark",
      themeVariables: {
        primaryColor: "#111827",
        primaryBorderColor: "#22d3ee",
        primaryTextColor: "#e5e7eb",
        lineColor: "#22d3ee",
        secondaryColor: "#0b1222",
        tertiaryColor: "#0b1222",
        fontFamily: "system-ui, Segoe UI, Roboto, Helvetica, Arial",
        fontSize: "16px",
        labelBackground: "#1f2937",
        labelTextColor: "#e5e7eb",
        nodeBorder: "#22d3ee",
        clusterBackground: "#0b1222",
        clusterBorder: "#22d3ee"
      }
    });
  </script>
</head>
<body>
  <main class="wrap">
    <nav class="breadcrumb">
      <a href="index.html">ğŸ  Trang chá»§</a> > <span>Buá»•i 6</span>
    </nav>

    <h1>ğŸ® Dangerous Maze NÃ¢ng Cao - Buá»•i 6</h1>

    <!-- 1) Má»¥c tiÃªu -->
    <section class="card">
      <h2>1) ğŸ¯ Má»¥c tiÃªu buá»•i há»c</h2>
      <p>NÃ¢ng cáº¥p game Dangerous Maze vá»›i cÃ¡c tÃ­nh nÄƒng nÃ¢ng cao: báº«y di Ä‘á»™ng, há»‡ thá»‘ng Ä‘iá»ƒm sá»‘, lives, vÃ  nhiá»u level khÃ¡c nhau.</p>
      <ul class="tips">
        <li><strong>Táº¡o</strong> báº«y di Ä‘á»™ng tá»± Ä‘á»™ng theo Ä‘Æ°á»ng ray hoáº·c pattern.</li>
        <li><strong>XÃ¢y dá»±ng</strong> há»‡ thá»‘ng Ä‘iá»ƒm sá»‘ vÃ  máº¡ng sá»‘ng (lives).</li>
        <li><strong>Thiáº¿t káº¿</strong> nhiá»u mÃ n chÆ¡i (rooms) vá»›i Ä‘á»™ khÃ³ tÄƒng dáº§n.</li>
        <li><strong>ThÃªm</strong> hiá»‡u á»©ng Ã¢m thanh vÃ  particle khi va cháº¡m.</li>
      </ul>
    </section>

    <!-- 2) Flowchart -->
    <section class="card">
      <h2>2) ğŸ” Luá»“ng hoáº¡t Ä‘á»™ng nÃ¢ng cao</h2>
      <div class="mermaid">
flowchart TD
  A["ğŸš€ Báº¯t Ä‘áº§u game"] --> B["âš™ï¸ Khá»Ÿi táº¡o score, lives"]
  B --> C["ğŸ—ï¸ Load mÃ n chÆ¡i"]
  C --> D["ğŸ® Äiá»u khiá»ƒn player"]
  D --> E{"â“ Va cháº¡m?"}
  E -->|ğŸ§± TÆ°á»ng| F["â›” Cháº·n láº¡i"]
  E -->|âš ï¸ Báº«y| G["ğŸ’¥ Giáº£m lives"]
  E -->|ğŸ ÄÃ­ch| H["ğŸ‰ TÄƒng score"]
  E -->|â­ Coin| I["ğŸ’° Nháº·t Ä‘iá»ƒm"]
  F --> D
  G --> J{"â“ Lives > 0?"}
  J -->|CÃ³| K["ğŸ”„ Respawn"]
  J -->|KhÃ´ng| L["ğŸ’€ Game Over"]
  K --> D
  I --> D
  H --> M{"â“ CÃ²n mÃ n?"}
  M -->|CÃ³| N["â¡ï¸ MÃ n tiáº¿p theo"]
  M -->|KhÃ´ng| O["ğŸ† HoÃ n thÃ nh game"]
  N --> C
      </div>
      <p class="note">ğŸ“Œ Náº¿u sÆ¡ Ä‘á»“ khÃ´ng hiá»‡n, kiá»ƒm tra máº¡ng (cáº§n táº£i Mermaid) hoáº·c thá»­ trÃ¬nh duyá»‡t khÃ¡c.</p>
    </section>

    <!-- 3) Báº«y di Ä‘á»™ng -->
    <section class="card">
      <h2>3) âš¡ Báº«y di Ä‘á»™ng tá»± Ä‘á»™ng</h2>
      <p>Báº«y di Ä‘á»™ng táº¡o thÃªm thá»­ thÃ¡ch, yÃªu cáº§u ngÆ°á»i chÆ¡i tÃ­nh toÃ¡n thá»i Ä‘iá»ƒm di chuyá»ƒn.</p>

      <h3>a) Báº«y di chuyá»ƒn ngang/dá»c</h3>
      <pre><code>/// Create Event - obj_trap_moving
move_speed = 2;
move_dir = 1;  // 1: pháº£i/xuá»‘ng, -1: trÃ¡i/lÃªn
start_x = x;   // Vá»‹ trÃ­ báº¯t Ä‘áº§u
start_y = y;
move_range = 128;  // Di chuyá»ƒn 128 pixel rá»“i quay láº¡i
move_horizontal = true;  // true: ngang, false: dá»c

/// Step Event - obj_trap_moving
if (move_horizontal) {
    x += move_speed * move_dir;
    // Äáº£o chiá»u khi Ä‘áº¿n giá»›i háº¡n
    if (abs(x - start_x) >= move_range) {
        move_dir *= -1;
    }
} else {
    y += move_speed * move_dir;
    if (abs(y - start_y) >= move_range) {
        move_dir *= -1;
    }
}</code></pre>

      <h3>b) Báº«y di chuyá»ƒn theo Ä‘Æ°á»ng trÃ²n</h3>
      <pre><code>/// Create Event - obj_trap_circular
center_x = x;
center_y = y;
radius = 64;
angle = 0;
rotate_speed = 2;

/// Step Event - obj_trap_circular
angle += rotate_speed;
x = center_x + lengthdir_x(radius, angle);
y = center_y + lengthdir_y(radius, angle);</code></pre>

      <h3>c) Báº«y theo path (Ä‘Æ°á»ng Ä‘i phá»©c táº¡p)</h3>
      <p>Táº¡o <strong>Path</strong> trong IDE, sau Ä‘Ã³ gÃ¡n cho báº«y:</p>
      <pre><code>/// Create Event - obj_trap_path
// path_trap_route lÃ  path Ä‘Ã£ táº¡o trong IDE
path_start(path_trap_route, 3, path_action_restart, true);</code></pre>

      <h3>d) Va cháº¡m vá»›i báº«y di Ä‘á»™ng</h3>
      <pre><code>/// Collision Event (obj_player with obj_trap_moving)
// Giáº£m máº¡ng
global.lives -= 1;

// Hiá»‡u á»©ng rung mÃ n hÃ¬nh
screen_shake(10, 5);

// PhÃ¡t Ã¢m thanh
audio_play_sound(snd_hit, 1, false);

// Kiá»ƒm tra game over
if (global.lives <= 0) {
    show_message("ğŸ’€ Háº¿t máº¡ng! Game Over!");
    game_restart();
} else {
    // Respawn vá» vá»‹ trÃ­ ban Ä‘áº§u
    x = global.start_x;
    y = global.start_y;
}</code></pre>
    </section>

    <!-- 4) Há»‡ thá»‘ng Ä‘iá»ƒm & lives -->
    <section class="card">
      <h2>4) ğŸ† Há»‡ thá»‘ng Ä‘iá»ƒm sá»‘ vÃ  máº¡ng sá»‘ng</h2>
      
      <h3>a) Khá»Ÿi táº¡o biáº¿n toÃ n cá»¥c</h3>
      <pre><code>/// Create Event - obj_game_controller
global.score = 0;
global.lives = 3;
global.level = 1;
global.start_x = 32;  // Vá»‹ trÃ­ respawn
global.start_y = 32;</code></pre>

      <h3>b) Hiá»ƒn thá»‹ Ä‘iá»ƒm sá»‘ trÃªn mÃ n hÃ¬nh</h3>
      <pre><code>/// Draw GUI Event - obj_game_controller
draw_set_color(c_white);
draw_set_font(fnt_ui);  // Font Ä‘Ã£ táº¡o trong IDE

// Hiá»ƒn thá»‹ lives
draw_text(20, 20, "Lives: " + string(global.lives));

// Hiá»ƒn thá»‹ score
draw_text(20, 50, "Score: " + string(global.score));

// Hiá»ƒn thá»‹ level
draw_text(20, 80, "Level: " + string(global.level));</code></pre>

      <h3>c) Táº¡o váº­t pháº©m thu tháº­p (coins)</h3>
      <pre><code>/// Collision Event (obj_player with obj_coin)
global.score += 10;
audio_play_sound(snd_coin, 1, false);
instance_destroy();  // XÃ³a coin sau khi nháº·t</code></pre>

      <h3>d) Äiá»ƒm thÆ°á»Ÿng khi hoÃ n thÃ nh mÃ n</h3>
      <pre><code>/// Collision Event (obj_player with obj_goal)
// ThÆ°á»Ÿng Ä‘iá»ƒm dá»±a vÃ o lives cÃ²n láº¡i
var bonus = global.lives * 100;
global.score += bonus;

show_message("ğŸ† HoÃ n thÃ nh! ThÆ°á»Ÿng: " + string(bonus) + " Ä‘iá»ƒm!");

global.level += 1;

// Chuyá»ƒn mÃ n tiáº¿p theo
if (room_exists(room_next)) {
    room_goto_next();
} else {
    show_message("ğŸ‰ ChÃºc má»«ng! Báº¡n Ä‘Ã£ hoÃ n thÃ nh táº¥t cáº£ mÃ n chÆ¡i!");
    game_restart();
}</code></pre>
    </section>

    <!-- 5) Nhiá»u mÃ n chÆ¡i -->
    <section class="card">
      <h2>5) ğŸ—ºï¸ Thiáº¿t káº¿ nhiá»u mÃ n chÆ¡i</h2>
      
      <h3>a) NguyÃªn táº¯c thiáº¿t káº¿ level</h3>
      <ul class="tips">
        <li><strong>MÃ n 1</strong>: ÄÆ¡n giáº£n, Ã­t báº«y, giÃºp ngÆ°á»i chÆ¡i lÃ m quen.</li>
        <li><strong>MÃ n 2-3</strong>: ThÃªm báº«y di Ä‘á»™ng, lá»‘i Ä‘i háº¹p hÆ¡n.</li>
        <li><strong>MÃ n 4+</strong>: Káº¿t há»£p nhiá»u loáº¡i báº«y, yÃªu cáº§u timing chÃ­nh xÃ¡c.</li>
      </ul>

      <h3>b) Táº¡o rooms vÃ  sáº¯p xáº¿p thá»© tá»±</h3>
      <ul class="tips">
        <li>Táº¡o nhiá»u room: <code>rm_level1</code>, <code>rm_level2</code>, <code>rm_level3</code>...</li>
        <li>Trong <strong>Room Manager</strong>, kÃ©o tháº£ Ä‘á»ƒ sáº¯p xáº¿p thá»© tá»± Ä‘Ãºng.</li>
        <li>Äáº£m báº£o má»—i room cÃ³ <code>obj_game_controller</code> vÃ  <code>obj_player</code>.</li>
      </ul>

      <h3>c) Persistent objects</h3>
      <p>Äá»ƒ giá»¯ nguyÃªn Ä‘iá»ƒm sá»‘ khi chuyá»ƒn mÃ n:</p>
      <pre><code>/// Create Event - obj_game_controller
persistent = true;  // Object khÃ´ng bá»‹ xÃ³a khi Ä‘á»•i room</code></pre>

      <h3>d) Reset khi game over</h3>
      <pre><code>/// Game Over function
function game_over() {
    show_message("ğŸ’€ Game Over!\nScore: " + string(global.score));
    
    // Reset biáº¿n
    global.score = 0;
    global.lives = 3;
    global.level = 1;
    
    // Vá» mÃ n Ä‘áº§u
    room_goto(rm_level1);
}</code></pre>
    </section>

    <!-- 6) Hiá»‡u á»©ng nÃ¢ng cao -->
    <section class="card">
      <h2>6) âœ¨ Hiá»‡u á»©ng Ã¢m thanh vÃ  visual</h2>

      <h3>a) Rung mÃ n hÃ¬nh (screen shake)</h3>
      <pre><code>/// Create Event - obj_camera_controller
shake_magnitude = 0;
shake_duration = 0;

function screen_shake(magnitude, duration) {
    shake_magnitude = magnitude;
    shake_duration = duration;
}

/// Step Event - obj_camera_controller
if (shake_duration > 0) {
    shake_duration -= 1;
    
    // Táº¡o offset ngáº«u nhiÃªn
    var shake_x = random_range(-shake_magnitude, shake_magnitude);
    var shake_y = random_range(-shake_magnitude, shake_magnitude);
    
    // Di chuyá»ƒn camera
    camera_set_view_pos(view_camera[0], 
        shake_x, shake_y);
} else {
    // Vá» vá»‹ trÃ­ bÃ¬nh thÆ°á»ng
    camera_set_view_pos(view_camera[0], 0, 0);
    shake_magnitude = 0;
}</code></pre>

      <h3>b) Particle khi cháº¡m báº«y</h3>
      <pre><code>/// Create Event - obj_player
// Táº¡o particle system
part_sys = part_system_create();
part_type = part_type_create();

// Cáº¥u hÃ¬nh particle
part_type_shape(part_type, pt_shape_spark);
part_type_size(part_type, 0.1, 0.3, -0.01, 0);
part_type_color1(part_type, c_red);
part_type_alpha2(part_type, 1, 0);
part_type_speed(part_type, 2, 5, -0.1, 0);
part_type_direction(part_type, 0, 360, 0, 0);
part_type_life(part_type, 20, 40);

/// Khi cháº¡m báº«y
function create_hit_effect() {
    part_particles_create(part_sys, x, y, part_type, 20);
}</code></pre>

      <h3>c) ThÃªm Ã¢m thanh</h3>
      <pre><code>/// CÃ¡c sá»± kiá»‡n cáº§n Ã¢m thanh
// Nháº·t coin
audio_play_sound(snd_coin, 1, false);

// Cháº¡m báº«y
audio_play_sound(snd_hit, 1, false);

// HoÃ n thÃ nh mÃ n
audio_play_sound(snd_victory, 1, false);

// Background music (láº·p láº¡i)
audio_play_sound(snd_bgm, 1, true);</code></pre>
    </section>

    <!-- 7) Tá»‘i Æ°u hÃ³a -->
    <section class="card">
      <h2>7) âš™ï¸ Tá»‘i Æ°u hÃ³a vÃ  debug</h2>

      <h3>a) Debug mode</h3>
      <pre><code>/// Create Event - obj_game_controller
global.debug_mode = false;

/// Step Event
if (keyboard_check_pressed(vk_f1)) {
    global.debug_mode = !global.debug_mode;
}

/// Draw Event - obj_player (náº¿u debug mode)
if (global.debug_mode) {
    draw_set_color(c_lime);
    draw_rectangle(bbox_left, bbox_top, bbox_right, bbox_bottom, true);
    draw_text(x, y - 20, "Speed: " + string(speed));
}</code></pre>

      <h3>b) Cheat codes Ä‘á»ƒ test</h3>
      <pre><code>/// Step Event - obj_game_controller
// Nháº¥n F2 Ä‘á»ƒ invincible
if (keyboard_check_pressed(vk_f2)) {
    global.invincible = !global.invincible;
}

// Nháº¥n F3 Ä‘á»ƒ skip level
if (keyboard_check_pressed(vk_f3)) {
    room_goto_next();
}

// Nháº¥n F4 Ä‘á»ƒ +1000 Ä‘iá»ƒm
if (keyboard_check_pressed(vk_f4)) {
    global.score += 1000;
}</code></pre>

      <h3>c) Giáº£m collision checks</h3>
      <pre><code>/// Thay vÃ¬ check collision má»—i frame, cache káº¿t quáº£
var check_collision_timer = 0;
var is_on_ground = false;

if (check_collision_timer <= 0) {
    is_on_ground = place_meeting(x, y + 1, obj_wall);
    check_collision_timer = 3;  // Check má»—i 3 frames
} else {
    check_collision_timer -= 1;
}</code></pre>
    </section>

    <!-- 8) Máº¹o nÃ¢ng cao -->
    <section class="card">
      <h2>8) ğŸ’¡ Máº¹o nÃ¢ng cao</h2>
      <ul class="tips">
        <li><strong>Checkpoint</strong>: Táº¡o <code>obj_checkpoint</code> Ä‘á»ƒ lÆ°u vá»‹ trÃ­, ngÆ°á»i chÆ¡i respawn táº¡i Ä‘Ã³ thay vÃ¬ vá» Ä‘áº§u mÃ n.</li>
        <li><strong>Timer</strong>: ThÃªm Ä‘á»“ng há»“ Ä‘áº¿m ngÆ°á»£c, hoÃ n thÃ nh nhanh Ä‘Æ°á»£c Ä‘iá»ƒm thÆ°á»Ÿng.</li>
        <li><strong>Power-ups</strong>: Táº¡o váº­t pháº©m tÄƒng tá»‘c Ä‘á»™, invincible táº¡m thá»i, hoáº·c slow-motion.</li>
        <li><strong>Leaderboard</strong>: LÆ°u high score vÃ o file hoáº·c ini Ä‘á»ƒ so sÃ¡nh.</li>
        <li><strong>Tutorial</strong>: Táº¡o room hÆ°á»›ng dáº«n trÆ°á»›c mÃ n 1 vá»›i text vÃ  mÅ©i tÃªn chá»‰ dáº«n.</li>
      </ul>

      <h3>VÃ­ dá»¥: Checkpoint system</h3>
      <pre><code>/// Collision Event (obj_player with obj_checkpoint)
if (!activated) {
    global.checkpoint_x = x;
    global.checkpoint_y = y;
    activated = true;
    sprite_index = spr_checkpoint_active;
    audio_play_sound(snd_checkpoint, 1, false);
}

/// Khi respawn
x = global.checkpoint_x;
y = global.checkpoint_y;</code></pre>
    </section>

    <!-- 9) Lá»—i thÆ°á»ng gáº·p -->
    <section class="card">
      <h2>9) ğŸš« Lá»—i thÆ°á»ng gáº·p vÃ  cÃ¡ch sá»­a</h2>
      <ul class="tips">
        <li><strong>Báº«y di Ä‘á»™ng xuyÃªn tÆ°á»ng</strong>: ThÃªm <code>place_meeting()</code> cho báº«y, Ä‘áº£o chiá»u khi cháº¡m tÆ°á»ng.</li>
        <li><strong>Lives Ã¢m</strong>: ThÃªm check <code>if (global.lives > 0)</code> trÆ°á»›c khi giáº£m.</li>
        <li><strong>Score khÃ´ng lÆ°u khi chuyá»ƒn mÃ n</strong>: DÃ¹ng <code>global.</code> cho biáº¿n hoáº·c set <code>persistent = true</code> cho controller.</li>
        <li><strong>Ã‚m thanh chá»“ng chÃ©o</strong>: DÃ¹ng <code>audio_stop_sound()</code> trÆ°á»›c khi play láº¡i.</li>
        <li><strong>Particle khÃ´ng xuáº¥t hiá»‡n</strong>: Kiá»ƒm tra Ä‘Ã£ táº¡o system vÃ  type chÆ°a, gá»i <code>part_particles_create()</code> Ä‘Ãºng vá»‹ trÃ­.</li>
      </ul>
    </section>

    <!-- 10) TÃ³m táº¯t -->
    <section class="card">
      <h2>10) ğŸ¯ TÃ³m táº¯t buá»•i há»c</h2>
      <p>Trong buá»•i há»c nÃ y, chÃºng ta Ä‘Ã£ há»c Ä‘Æ°á»£c:</p>
      <ul class="tips">
        <li>âœ… Táº¡o <strong>báº«y di Ä‘á»™ng</strong> vá»›i nhiá»u pattern khÃ¡c nhau (ngang/dá»c, trÃ²n, path).</li>
        <li>âœ… XÃ¢y dá»±ng <strong>há»‡ thá»‘ng Ä‘iá»ƒm sá»‘, lives</strong> vÃ  hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh.</li>
        <li>âœ… Thiáº¿t káº¿ <strong>nhiá»u mÃ n chÆ¡i</strong> vá»›i Ä‘á»™ khÃ³ tÄƒng dáº§n vÃ  persistent data.</li>
        <li>âœ… ThÃªm <strong>hiá»‡u á»©ng</strong> nhÆ° screen shake, particles, vÃ  Ã¢m thanh.</li>
        <li>âœ… Tá»‘i Æ°u hÃ³a game vá»›i <strong>debug mode</strong> vÃ  cheat codes.</li>
      </ul>
      <p><strong>BÃ i táº­p vá» nhÃ :</strong> Táº¡o Ã­t nháº¥t 3 mÃ n chÆ¡i hoÃ n chá»‰nh vá»›i Ä‘á»™ khÃ³ tÄƒng dáº§n. ThÃªm checkpoint system vÃ  Ã­t nháº¥t 1 loáº¡i power-up (vÃ­ dá»¥: shield hoáº·c speed boost). Táº¡o mÃ n hÃ¬nh menu Ä‘Æ¡n giáº£n vá»›i nÃºt Start vÃ  Quit.</p>
    </section>

    <!-- Navigation -->
    <nav class="lesson-nav">
      <a href="lesson5.html" class="nav-link">â† Buá»•i 5: Platformer cÆ¡ báº£n</a>
      <a href="lesson7.html" class="nav-link">Buá»•i 7: AI vÃ  Enemy Behaviors â†’</a>
    </nav>
  </main>
</body>
</html>